(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{188:function(t,e,r){"use strict";r.r(e);var n=r(0),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t._m(0),t._v(" "),r("p",[t._v("Là client để gọi sang service authz "),r("router-link",{attrs:{to:"./service.html"}},[t._v("authz service")])],1),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"description"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#description"}},[this._v("#")]),this._v(" Description")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"project-structure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#project-structure"}},[this._v("#")]),this._v(" Project structure")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"https://s3-ap-southeast-1.amazonaws.com/gemtickets/production/dashboard/8509143c-6441-4877-a17a-5b726f06cf49.png",alt:"image"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("authz_client_example/main.go")]),this._v(": Code example khởi tạo client và call 1 số method tới server authz được chỉ định , cần sửa lại "),e("code",[this._v('address = "3.0.95.112:50051"')]),this._v(" thành địa chỉ của mình, nếu chạy service authz ở local, "),e("code",[this._v('address = "localhost:50051"')]),this._v(" ( tùy dưới local có nhiều service grpc hay ko )")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"use"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#use"}},[this._v("#")]),this._v(" Use")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"khoi-tao"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#khoi-tao"}},[this._v("#")]),this._v(" Khởi tạo")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('import\tauthzclient "github.com/es-hs/authzclient"\n\naddress := "localhost:50051"\n\nerr := authzclient.InitAuthClient(address, grpc.WithInsecure(), grpc.WithBlock())\n// close connection khi đóng server\ndefer authzclient.Conn.Close()\n\n// add role authzclient.OWNER_ROLE cho user có ID=2009 vào shop có ID=2011\nr, err := authzclient.AddRoleToDomain(2009, 2011, authzclient.OWNER_ROLE)\nlogrus.Println(time.Since(t1))\nif err != nil {\n  log.Fatalf("err when call authz service %v", err)\n}\nlogrus.Println("Result ", r)\n\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"update-roles-va-permission"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#update-roles-va-permission"}},[this._v("#")]),this._v(" Update Roles và Permission")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Sau khi update roles và permission trên "),e("code",[this._v("authz service")]),this._v(" update file "),e("code",[this._v("constant.go")]),this._v(" giống với file "),e("code",[this._v("constant.go")]),this._v(" của version client đang sử dụng")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"khoi-tao-owner-role-cho-user-trong-1-shop-khoi-tao-viec-owner-inherit-role-admin-admin-inherit-tat-ca-cac-roles-con-lai"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#khoi-tao-owner-role-cho-user-trong-1-shop-khoi-tao-viec-owner-inherit-role-admin-admin-inherit-tat-ca-cac-roles-con-lai"}},[this._v("#")]),this._v(" Khởi tạo owner role cho user trong 1 shop, khởi tạo việc owner inherit role admin, admin inherit tất cả các roles còn lại")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('// khởi tạo owner role cho user có ID = 2009 trong shop có ID = 2011, khởi tạo việc owner inherit role admin, admin inherit tất cả các quyền còn lại\n\nr5, err := authzclient.GenerateOwnerRole(2009, 2011)\nif err != nil {\n  log.Fatalf("could not greet: %v", err)\n}\n\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('// add danh sách các role cho user ID = 2009 trong shop có ID = 2011,\n\nr6, err := authzclient.AddRolesForUserToDomain(2009, 2011, []string{authzclient.ADMIN_ROLE, authzclient.PRODUCT_READ})\nif err != nil {\n  log.Fatalf("could not greet: %v", err)\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('//show danh sách các roles của user có ID = 2009 trong shop có ID = 2011, chỉ các role trực tiếp, ko có role inherit\n\nroles, err = authzclient.GetRolesInDomain(2009, 2011)\nif err != nil {\n  log.Fatalf("could not greet: %v", err)\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('//show danh sách các roles và các inherited roles của user có ID = 2009 trong shop có ID = 2011, bao gồm các role trực tiếp, và có roles inherit\n\nroles, err = authzclient.GetRolesInDomain(2009, 2011)\nif err != nil {\n  log.Fatalf("could not greet: %v", err)\n}\n\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('// Remove 1 role của user có ID = 2009 trong shop có ID = 2011, chỉ các role trực tiếp, ko có role inherit\n\nr7, err := authzclient.RemoveRoleFromDomain(2009, 2011, authzclient.OWNER_ROLE)\nif err != nil {\n  log.Fatalf("could not greet: %v", err)\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('//Remove 1 danh sách roles của user có ID = 2009 trong shop có ID = 2011, chỉ các role trực tiếp, ko tính role inherit\n\nr8, err := authzclient.RemoveRolesFromDomain(2009, 2011, []string{authzclient.ADMIN_ROLE, authzclient.PRODUCT_READ})\nif err != nil {\n  log.Fatalf("could not greet: %v", err)\n}\n')])])])}],!1,null,null,null);e.default=s.exports}}]);